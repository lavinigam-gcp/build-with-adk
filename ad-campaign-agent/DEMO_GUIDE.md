# Ad Campaign Agent - Demo Query Journeys

This document contains complete user journeys for demonstrating the Ad Campaign Agent. Each journey is a multi-step conversation that showcases different capabilities from basic to advanced.

---

## Deployment Architecture

This demo is deployed to **Google Cloud Run** with the following architecture:

### Storage
- **Images/Videos**: Stored in GCS bucket `kaggle-on-gcp-ad-campaign-assets`
  - Seed images: `gs://kaggle-on-gcp-ad-campaign-assets/seed-images/`
  - Generated videos: `gs://kaggle-on-gcp-ad-campaign-assets/generated/`
- **Database**: SQLite (ephemeral - resets on container restart, mock data auto-populates)

### Models Used

| Purpose | Model | Notes |
|---------|-------|-------|
| Main Agent | `gemini-3-flash-preview` | Coordinator and all sub-agents |
| Scene Image Generation | `gemini-3-pro-image-preview` | Stage 1: Model wearing product |
| Video Animation | `veo-3.1-generate-preview` | Stage 2: 8-second fashion videos |
| Chart Visualizations | `gemini-3-pro-image-preview` | Metrics charts with anti-hallucination templates |
| Map Visualizations | `gemini-3-pro-image-preview` | AI-generated map infographics |
| Video Analysis | `gemini-3-flash-preview` | Video property extraction |

### Two-Stage Video Generation Pipeline (NEW)

```
Stage 1: Scene Image (Gemini 3 Pro Image)
    Input: Product image + CreativeVariation parameters
    Output: Scene-ready first frame (model wearing product)
    Saved as: thumbnail

Stage 2: Video Animation (Veo 3.1)
    Input: Scene image + Animation prompt
    Output: 8-second 9:16 video
    Saved as: final video
```

### Multi-Agent Architecture

```
Coordinator Agent (root_agent)
├── Campaign Agent    → Campaign CRUD, locations, demographics
├── Media Agent       → Products, videos, two-stage pipeline, variations
├── Review Agent      → HITL activation, video status, metrics generation (NEW)
└── Analytics Agent   → Metrics, insights, charts, Google Maps integration
```

### Viewing Generated Artifacts

All generated media is saved as ADK artifacts, viewable in the Web UI:
1. Open the ADK Web UI (`/dev-ui` endpoint)
2. Click the **Artifacts** panel (right side)
3. Select any artifact to view/download

**Artifact types:**
- Videos (`.mp4`) - Generated by Veo 3.1
- Images (`.png`) - Generated by Gemini 3 Pro Image
- Charts (`.png`) - Metrics visualizations
- Maps (`.png`) - Geographic visualizations

---

## Pre-loaded Demo Data Reference

Before running demos, note the pre-loaded data. Mock data auto-populates on each container start.

### Product-Centric Model (KEY CONCEPT)

Each campaign = **1 product + 1 store location**. This enables:
- Clear metrics attribution per product per store
- A/B testing with video variations for the same product
- Same product at different stores = different campaigns

### Products (22 Pre-loaded)

Browse with `list_products()` or `list_products(category="dress")`:

| Category | Count | Example Products |
|----------|-------|------------------|
| Dress | 8 | blue-floral-maxi-dress, elegant-black-cocktail-dress, emerald-satin-slip-dress |
| Top | 6 | classic-white-blouse, silk-camisole, fitted-blazer |
| Pants | 4 | black-high-waist-trousers, wide-leg-linen-pants |
| Outerwear | 2 | wool-peacoat, leather-jacket |
| Skirt | 2 | pleated-midi-skirt, denim-mini-skirt |

### Campaigns (Product-Centric)

| ID | Campaign Name | Store | City | Product | Status |
|----|---------------|-------|------|---------|--------|
| 1 | Blue Floral Maxi Dress - Westfield Century City | Westfield Century City | Los Angeles, CA | blue-floral-maxi-dress | Active |
| 2 | Elegant Black Cocktail Dress - Bloomingdale's 59th Street | Bloomingdale's 59th Street | New York, NY | elegant-black-cocktail-dress | Active |
| 3 | Black High Waist Trousers - Water Tower Place | Water Tower Place | Chicago, IL | black-high-waist-trousers | Active |
| 4 | Emerald Satin Slip Dress - The Grove | The Grove | Los Angeles, CA | emerald-satin-slip-dress | Active |

### HITL Video Workflow (NEW)

Videos have a lifecycle status:

| Status | Description | Metrics? |
|--------|-------------|----------|
| `generated` | Video created, pending review | NO |
| `activated` | Pushed live by Review Agent | YES (30 days generated) |
| `paused` | Temporarily stopped | Preserved |
| `archived` | Rejected/removed | N/A |

**Important:** Videos do NOT have metrics until activated via Review Agent!

### Metrics Data (NEW Schema)

Metrics are stored in `video_metrics` table and linked to `campaign_videos`.
**Metrics only exist for ACTIVATED videos** (30 days generated on activation).

| Metric | DB Column | Description | Typical Range |
|--------|-----------|-------------|---------------|
| `impressions` | `impressions` | Ad displays on in-store screens | 800-2,000/day |
| `dwell_time` | `dwell_time_seconds` | Avg seconds viewing | 3-8 seconds |
| `circulation` | `circulation` | Foot traffic past display | 1,500-4,000/day |
| `revenue` | `revenue` | Revenue for RPI calculation | $30-$120/day |
| `RPI` | (computed) | Revenue Per Impression | $0.02-$0.08 |

**Key Tables (NEW Schema):**
- `campaign_videos` - Videos with HITL lifecycle status
- `video_metrics` - Daily metrics per activated video
- `products` - 22 pre-loaded fashion products

**Performance multipliers by location:**
- Los Angeles (Campaign 1): 1.2x (flagship store)
- New York (Campaign 2): 0.9x (boutique)
- Chicago (Campaign 3): 1.0x (baseline)
- Seattle (Campaign 4): 0.7x (smaller market)

**Patterns:** Weekend metrics are ~40% higher than weekdays

---

## Journey 1: Quick Campaign Overview (Basic - 3 steps)

**Persona:** Executive wanting a quick status update
**Duration:** ~2 minutes
**Agents Used:** Campaign Agent, Analytics Agent

### Step 1: Get the big picture
```
Query: "Show me all our active ad campaigns"
```
**Agent:** Campaign Agent → `list_campaigns(status="active")`

**Sample Response:**
```json
{
  "status": "success",
  "total_count": 3,
  "campaigns": [
    {"id": 1, "name": "Summer Blooms 2025", "location": "Los Angeles, CA", "category": "summer", "status": "active", "image_count": 1, "ad_count": 1},
    {"id": 2, "name": "Evening Elegance Collection", "location": "New York, NY", "category": "formal", "status": "active", "image_count": 2, "ad_count": 2},
    {"id": 3, "name": "Urban Professional", "location": "Chicago, IL", "category": "professional", "status": "active", "image_count": 3, "ad_count": 3}
  ]
}
```

**What to Look For:**
- 3 campaigns returned (IDs 1, 2, 3)
- Each shows image_count and ad_count
- Fall Essentials (ID 4) NOT shown because status is "draft"

### Step 2: Check overall performance
```
Query: "How are they performing? Which one is doing best?"
```
**Agent:** Analytics Agent → `compare_campaigns(campaign_ids=[1,2,3])`

**Expected Response:**
- Comparison of all 3 active campaigns
- Metrics: impressions, dwell time, circulation, RPI (Revenue Per Impression)
- Clear winner identified by RPI (likely Summer Blooms based on mock data)
- RPI ranking (the primary KPI for retail media)

### Step 3: Get quick insights
```
Query: "Why is Summer Blooms 2025 doing so well? Give me the key insights."
```
**Agent:** Analytics Agent → `get_campaign_insights(campaign_id=1)`

**Expected Response:**
- Performance trend (improving/stable/declining)
- Key characteristics of top-performing ads (mood, setting, style)
- Actionable recommendations
- Best performing day highlighted

---

## Journey 2: Two-Stage Video Generation with HITL (End-to-End - 8 steps)

**Persona:** Campaign Manager launching a new campaign
**Duration:** ~12 minutes (includes video generation wait)
**Agents Used:** Campaign Agent, Media Agent, Review Agent

### Step 1: Browse available products
```
Query: "Show me available products for a holiday campaign"
```
**Agent:** Media Agent → `list_products(category="dress")`

**Expected Response:**
- List of 22 products across categories
- Each with: id, name, category, color, style, fabric
- Filter by category available

### Step 2: Create product-centric campaign
```
Query: "Create a campaign for the elegant black cocktail dress at our Miami store"
```
**Agent:** Campaign Agent → `create_campaign(product_id=2, store_name="Aventura Mall", city="Miami", state="Florida")`

**Expected Response:**
- New campaign created with auto-generated name: "Elegant Black Cocktail Dress - Aventura Mall"
- Product linked to campaign
- Status: draft

### Step 3: View variation presets
```
Query: "What variation options do I have for video generation?"
```
**Agent:** Media Agent → `get_variation_presets()`

**Expected Response:**
- Preset variation sets:
  - **diversity**: Different model ethnicities (asian, european, african, latina, south-asian)
  - **settings**: Different locations (studio, beach, urban, cafe, rooftop, garden)
  - **moods**: Different tones (elegant, romantic, bold, playful, sophisticated)

### Step 4: Generate video with creative variation ⭐ TWO-STAGE PIPELINE
```
Query: "Generate a video for this campaign with an Asian model on a beach at golden hour"
```
**Agent:** Media Agent → `generate_video_with_variation(campaign_id, product_id, model_ethnicity="asian", setting="beach", time_of_day="golden-hour")`
**Stage 1:** gemini-3-pro-image-preview (scene image with model wearing product)
**Stage 2:** veo-3.1-generate-preview (8-second animation)

**Sample Response:**
```json
{
  "status": "success",
  "message": "Video generated successfully. Use activate_video to push live.",
  "video": {
    "id": 5,
    "campaign_id": 5,
    "product_name": "elegant-black-cocktail-dress",
    "video_filename": "elegant-black-cocktail-dress-121924-asian-beach-golden-hour.mp4",
    "thumbnail_path": "elegant-black-cocktail-dress-121924-asian-beach-golden-hour-thumbnail.png",
    "variation": "asian-beach-golden-hour",
    "pipeline": "two-stage",
    "duration_seconds": 8,
    "generation_time_seconds": 245,
    "status": "generated"
  },
  "note": "Video is in 'generated' status. Metrics will only be created after activation."
}
```

**What to Look For:**
- Thumbnail saved for preview (scene image from Stage 1)
- Status is `generated` (NOT activated yet)
- NO metrics until activated
- Descriptive filename with product-date-variation

### Step 5: Generate more variations
```
Query: "Generate two more variations: one with a European model in an urban setting,
and one with a Latina model at a rooftop at sunset"
```
**Agent:** Media Agent → `generate_video_with_variation()` (called twice)

**Expected Response:**
- Two more videos generated in parallel
- Different variations: "european-urban-day", "latina-rooftop-sunset"
- All with status `generated`

### Step 6: Review pending videos ⭐ HITL WORKFLOW
```
Query: "Show me all pending videos for review"
```
**Agent:** Review Agent → `get_video_review_table(status="generated")`

**Expected Response:**
- Formatted table with all pending videos:
  - Video ID, Status, Product, Store, Variation
  - **Clickable View links** to preview videos in browser
  - Product image links
- Instructions: "To activate, say: activate 5, 6, 7"

### Step 7: Activate selected videos ⭐ ACTIVATION
```
Query: "The beach and rooftop videos look great. Activate videos 5 and 7."
```
**Agent:** Review Agent → `activate_batch([5, 7])`

**Expected Response:**
- Videos activated and now LIVE
- 30 days of mock metrics generated for each
- Status changed to `activated`
- Urban variation (6) remains in `generated` status for later

### Step 8: Check activation summary
```
Query: "Give me a summary of video statuses for this campaign"
```
**Agent:** Review Agent → `get_activation_summary(campaign_id=5)`

**Expected Response:**
- Status counts: 2 activated (live), 1 generated (pending)
- Total videos: 3
- Reminder: Analytics Agent can now show metrics for activated videos

---

## Journey 3: Performance Analysis & Optimization (Intermediate - 5 steps)

**Persona:** Marketing Analyst optimizing campaign performance
**Duration:** ~5 minutes
**Agents Used:** Analytics Agent, Media Agent

### Step 1: Compare all campaigns
```
Query: "Compare the performance of all our campaigns side by side"
```
**Agent:** Analytics Agent → `compare_campaigns(campaign_ids=[1,2,3])`

**Expected Response:**
- Table/comparison of all campaigns
- Metrics per campaign: impressions, dwell time, circulation, revenue
- RPI (Revenue Per Impression) comparison
- Rankings by RPI and total revenue
- Best performer highlighted

### Step 2: Find top performing videos
```
Query: "What are our top 5 best performing video ads by RPI?"
```
**Agent:** Analytics Agent → `get_top_performing_ads(metric="revenue_per_impression", limit=5)`

**Expected Response:**
- Ranked list of top 5 videos from `campaign_videos` table
- For each video:
  - Campaign name and location
  - Product info (name, category, color, style)
  - RPI, impressions, dwell time, circulation
  - Variation characteristics (model ethnicity, setting, mood)
- Common traits among top performers identified
- Note: Only includes ACTIVATED videos with metrics

### Step 3: Deep dive on winner
```
Query: "Give me detailed insights on the #1 performing ad. What makes it work?"
```
**Agent:** Analytics Agent → `get_campaign_insights(campaign_id=1)`
**Agent:** Media Agent → `get_video_properties(ad_id=1)`

**Expected Response:**
- Full ad details
- Image metadata breakdown
- Prompt that was used
- Performance metrics over time
- AI analysis of success factors:
  - Mood resonates with audience
  - Setting matches brand
  - Camera style creates engagement
- Specific recommendations

### Step 4: Apply winning formula ⭐ KEY FEATURE
```
Query: "Apply the winning formula from our top ad to the Urban Professional campaign in Chicago"
```
**Agent:** Media Agent → `apply_winning_formula(target_campaign_id=3, source_ad_id=1)`
**Model:** veo-3.1-generate-preview (generates new video with winning characteristics)

**Expected Response:**
- Winning characteristics extracted from video_properties:
  - mood, visual_style, energy_level, color_temperature, camera_movement
- New video generated for Urban Professional (Campaign 3)
- Same successful elements, different product
- Video saved as artifact
- Comparison of applied formula

### Step 5: Verify improvement potential
```
Query: "Show me metrics for Urban Professional before and after. Create a comparison chart."
```
**Agent:** Analytics Agent → `generate_metrics_visualization(campaign_id=3, chart_type="trendline")`
**Model:** gemini-3-pro-image-preview (generates chart)

**Expected Response:**
- Metrics visualization generated (saved as artifact)
- Chart showing campaign performance
- Note: New video just created, metrics will accumulate
- Projection based on winning formula success rate

---

## Journey 4: Geographic Strategy & Google Maps Integration (Intermediate - 8 steps)

**Persona:** Director of Retail Media Networks
**Duration:** ~7 minutes
**Agents Used:** Campaign Agent, Analytics Agent

### Step 1: Get rich campaign map data ⭐ NEW FEATURE
```
Query: "Show me all campaign locations with Google Maps links"
```
**Agent:** Analytics Agent → `get_campaign_map_data()`

**Expected Response:**
- Rich location data with clickable Google Maps URLs:
  - **Direct links** to open each store in Google Maps
  - Product info and images for each location
  - Video thumbnails and URLs
  - Performance metrics per location
- Summary with total revenue, impressions, active videos

**Sample Response:**
```json
{
  "status": "success",
  "locations": [
    {
      "campaign_id": 1,
      "campaign_name": "Blue Floral Maxi - Westfield LA",
      "store_name": "Westfield Century City",
      "google_maps_url": "https://www.google.com/maps/search/?api=1&query=...",
      "product": {"name": "blue-floral-maxi-dress", "image_url": "..."},
      "videos": [{"id": 1, "video_url": "...", "thumbnail_url": "..."}],
      "metrics": {"total_revenue": 45230.50, "rpi": 0.362}
    }
  ]
}
```

### Step 2: Generate real Google Static Map ⭐ NEW FEATURE
```
Query: "Create a static map image with all store locations"
```
**Agent:** Analytics Agent → `generate_static_map(color_by="revenue")`
**API:** Google Static Maps API

**Expected Response:**
- Real Google Maps image with markers
- Color-coded markers:
  - Green = high revenue (>$30K)
  - Yellow = medium revenue ($15K-$30K)
  - Red = lower revenue (<$15K)
- Clickable individual Google Maps URLs for each marker
- Direct link to view the map image

### Step 3: Generate AI performance map with style
```
Query: "Create an infographic map showing campaign performance"
```
**Agent:** Analytics Agent → `generate_map_visualization(visualization_type="performance_map", style="infographic")`
**Model:** gemini-3-pro-image-preview

**Expected Response:**
- AI-generated infographic map (saved as artifact)
- US map with revenue bubbles at each location
- Clean business dashboard style
- Legend and summary stats panel

### Step 4: Try artistic map style ⭐ STYLE OPTIONS
```
Query: "Create an artistic magazine-style map visualization"
```
**Agent:** Analytics Agent → `generate_map_visualization(visualization_type="performance_map", style="artistic")`

**Expected Response:**
- Magazine-quality editorial map
- Elegant typography and sophisticated colors
- Fashion-forward visual language
- Same data, different presentation

### Step 5: Regional comparison
```
Query: "How does the West Coast compare to East Coast in terms of RPI?"
```
**Agent:** Analytics Agent → `generate_map_visualization(visualization_type="regional_comparison", style="simple")`

**Expected Response:**
- Minimal, data-focused regional comparison
- Bar chart with actual values
- West Coast vs East Coast vs Midwest
- RPI, revenue, and impressions per region

### Step 6: Explore local market
```
Query: "What fashion stores are near our LA campaign location?"
```
**Agent:** Campaign Agent → `search_nearby_stores(city="Los Angeles", state="CA", business_type="fashion")`
**API:** Google Maps Places API

**Expected Response:**
- Nearby stores with Google Maps Place URLs
- Store names, ratings, addresses
- Click to open any store in Google Maps
- Competitive landscape insight

### Step 7: Get demographics
```
Query: "What are the demographics and fashion preferences in Los Angeles?"
```
**Agent:** Campaign Agent → `get_location_demographics(city="Los Angeles", state="CA")`

**Expected Response:**
- LA demographic data:
  - Population: ~3.9M
  - Median age: 35
  - Median income: $65K
  - Fashion market index: 92/100
- Style preferences: casual, athleisure, bohemian
- Market insight summary

### Step 8: Create market opportunity map
```
Query: "Generate a market opportunity visualization showing where we should expand"
```
**Agent:** Analytics Agent → `generate_map_visualization(visualization_type="market_opportunity", style="infographic")`

**Expected Response:**
- Market opportunity map generated
- Current locations with revenue halos
- Opportunity scores based on market index
- Expansion recommendations
- Underserved regions highlighted

---

## Journey 5: Creative Iteration & A/B Testing (Advanced - 7 steps)

**Persona:** Creative Director testing ad variations
**Duration:** ~15 minutes (includes multiple video generations)
**Agents Used:** Media Agent, Analytics Agent

### Step 1: Review existing ads
```
Query: "Show me all video ads for the Summer Blooms campaign"
```
**Expected Response:**
- List of ads for campaign 1
- Each ad showing:
  - Video filename
  - Duration
  - Prompt used
  - Source image
  - Status
  - Creation date

### Step 2: Analyze top performer
```
Query: "Which of these ads is performing best and what's its style?"
```
**Expected Response:**
- Top performing ad identified
- Revenue, dwell time, and RPI metrics
- Style analysis:
  - Mood (e.g., "dreamy, romantic")
  - Setting (e.g., "outdoor field")
  - Camera style (e.g., "slowly pans")
  - Key feature highlighted

### Step 3: Create setting variation
```
Query: "Generate a variation of the top ad but change the setting to something more urban"
```
**Expected Response:**
- Video variation generated
- Variation type: setting
- New setting applied (e.g., "luxurious urban rooftop")
- Original elements preserved
- Video saved as artifact

### Step 4: Create mood variation
```
Query: "Now create another variation with a more energetic, vibrant mood"
```
**Expected Response:**
- Second variation generated
- Variation type: mood
- New mood: "energetic, vibrant, youthful"
- Same product/setting as original
- Video saved as artifact

### Step 5: Create camera style variation
```
Query: "One more - try a dramatic low angle camera sweep"
```
**Expected Response:**
- Third variation generated
- Variation type: angle
- New camera: "dramatically sweeps from low angle upward"
- Cinematic effect applied
- Video saved as artifact

### Step 6: Compare all versions
```
Query: "Show me all the variations we just created and their prompts"
```
**Expected Response:**
- List of all Summer Blooms ads
- Original vs. 3 new variations
- Side-by-side prompt comparison
- Highlighted differences in each

### Step 7: Predict performance
```
Query: "Based on our historical data, which variation do you think will perform best?"
```
**Expected Response:**
- AI analysis of variations
- Comparison to past top performers
- Prediction based on:
  - Similar mood/setting success rates
  - Engagement patterns
  - Audience preferences
- Recommendation for A/B test priority

---

## Journey 6: Full Executive Demo (Comprehensive - 10 steps)

**Persona:** Demonstrating full platform capabilities to stakeholders
**Duration:** ~20 minutes
**Agents Used:** All three agents

### Step 1: Introduction
```
Query: "Give me an overview of our ad campaign management system and what campaigns we're running"
```
**Expected Response:**
- System overview (multi-agent architecture)
- 4 campaigns listed with status
- Quick metrics summary
- Capabilities overview

### Step 2: Deep dive on top performer
```
Query: "Tell me about our best performing campaign in detail"
```
**Expected Response:**
- Top campaign identified
- Full details: name, location, category
- Total revenue, impressions, dwell time, RPI
- Number of ads and images
- Performance trend

### Step 3: View the creative
```
Query: "Show me the images and videos for this campaign"
```
**Expected Response:**
- List of seed images with descriptions
- List of video ads with details
- Prompts used for generation
- Artifacts available in UI

### Step 4: Live video generation
```
Query: "Generate a new video ad for this campaign using a different image. Use the blouse image."
```
**Expected Response:**
- New video generation initiated
- Different seed image selected
- Auto-generated prompt from image analysis
- Video created and saved (wait 2-5 mins)
- Artifact viewable

### Step 5: Instant metrics
```
Query: "Now show me the performance metrics with a trend chart"
```
**Expected Response:**
- Campaign metrics summary
- 30-day performance data
- Trend visualization generated
- Chart saved as artifact
- Trend analysis (up/down/stable)

### Step 6: AI insights
```
Query: "What insights can you give me about what's working and what's not?"
```
**Expected Response:**
- AI-generated insights:
  - Success factors identified
  - Underperforming elements
  - Recommendations for improvement
  - Best/worst performing days
- Actionable suggestions

### Step 7: Cross-campaign comparison
```
Query: "Compare this to our other campaigns. Create an infographic."
```
**Expected Response:**
- Multi-campaign comparison
- Metrics table
- Infographic visualization generated
- Key differences highlighted
- Winner identified

### Step 8: Scale success
```
Query: "Take what's working from our top campaign and apply it to the Fall Essentials campaign in Seattle"
```
**Expected Response:**
- Fall Essentials identified (draft status)
- Winning formula extracted
- Applied characteristics listed
- New video generated
- Campaign optionally activated

### Step 9: Geographic visualization
```
Query: "Show me all our campaigns on a map with their performance"
```
**Expected Response:**
- Map visualization generated
- All 4+ campaigns plotted
- Revenue bubbles
- Regional performance summary
- Expansion opportunities

### Step 10: Summary and recommendations
```
Query: "Summarize what we should focus on next and any recommendations"
```
**Expected Response:**
- Executive summary:
  - Top performing: Summer Blooms 2025 (Campaign 1)
  - Key success factors
  - Underperforming areas
- Recommendations:
  - Apply winning formula to Fall Essentials
  - Expand to Miami or Denver region
  - Test mood or setting variation type
- Next steps

---

## Journey 7: Image-First Creative Workflow (Advanced - 6 steps)

**Persona:** Creative team starting from scratch
**Duration:** ~12 minutes
**Agents Used:** Media Agent, Campaign Agent

> **Note:** This journey demonstrates AI image generation with Gemini 3 Pro Image, allowing creative teams to generate custom fashion images when existing seed images don't fit the campaign vision.

### Step 1: Generate new seed image ⭐ AI IMAGE GENERATION
```
Query: "Generate a new fashion image for a winter coat campaign.
I want a model in a stylish wool peacoat, outdoor snowy city setting, elegant and sophisticated mood."
```
**Agent:** Media Agent → `generate_seed_image(prompt, aspect_ratio="9:16")`
**Model:** gemini-3-pro-image-preview (generates fashion image)
**Storage:** Saves to GCS `gs://kaggle-on-gcp-ad-campaign-assets/seed-images/`

**Expected Response:**
- AI image generation initiated
- Prompt processed with fashion-specific styling
- Image created with Gemini 3 Pro Image
- Saved to GCS seed-images/ folder as `generated_seed_*.png`
- Saved as ADK artifact (viewable in UI)
- Auto-analyzed by gemini-2.0-flash for metadata extraction

**Aspect ratio options:** `16:9` (landscape), `9:16` (portrait/vertical), `1:1` (square)

### Step 2: Review generated image
```
Query: "Describe the image you just created in detail"
```
**Agent:** Media Agent → `list_campaign_images(campaign_id)` or uses in-context memory

**Expected Response:**
- Full image analysis:
  - Model description (appearance, pose)
  - Clothing details (wool peacoat, colors, fit)
  - Setting (snowy city street)
  - Mood (elegant, sophisticated)
  - Suggested video elements (movement, camera style)
- Metadata stored in database

### Step 3: Create campaign for it
```
Query: "Create a new campaign called 'Winter Elegance' for Boston and add this image to it"
```
**Agent:** Campaign Agent → `create_campaign(name, city, state, category)`
**Agent:** Media Agent → `add_seed_image(campaign_id, image_filename)`

**Expected Response:**
- New campaign created (Boston, MA)
- Category: essentials/winter
- Status: draft
- Generated image added to campaign
- Ready for video generation

### Step 4: Generate video
```
Query: "Generate an 8-second cinematic video ad from this image"
```
**Agent:** Media Agent → `generate_video_ad(campaign_id, duration_seconds=8)`
**Model:** veo-3.1-generate-preview (2-5 min generation)

**Expected Response:**
- Video generation started (wait 2-5 minutes)
- Prompt auto-generated from image metadata
- 8-second duration set (Veo 3.1 supports 4, 6, or 8 seconds)
- Video saved to GCS and as artifact
- Video properties auto-extracted by gemini-2.5-pro
- Mock metrics generated (90 days)

### Step 5: Generate a second image variation
```
Query: "Generate another image with the same coat but in an indoor luxury hotel lobby setting"
```
**Agent:** Media Agent → `generate_seed_image(prompt, aspect_ratio="9:16")`
**Model:** gemini-3-pro-image-preview

**Expected Response:**
- Second image generated with different setting
- Same style coat preserved
- New setting: luxury hotel lobby
- Contrasting mood (warm, luxurious)
- Added to same campaign
- Analyzed and stored

### Step 6: Create second video for A/B test
```
Query: "Create a video from this new image too so we can A/B test the settings"
```
**Expected Response:**
- Second video generated
- Different prompt (hotel lobby setting)
- Same campaign, two creative directions
- Both videos available as artifacts
- Ready for performance comparison

---

## Journey 8: Property-Controlled Video Generation (Advanced - 5 steps)

**Persona:** Creative Director fine-tuning video style
**Duration:** ~12 minutes
**Agents Used:** Media Agent, Analytics Agent

### Step 1: View existing video properties
```
Query: "Show me the video properties for ad 21"
```
**Expected Response:**
- Full video properties breakdown:
  - Mood: romantic/warm/playful/etc.
  - Energy level: calm/moderate/dynamic
  - Visual style: cinematic/editorial/commercial
  - Color temperature: warm/neutral/cool
  - Camera movement: orbit/pan/static
  - Dominant colors: ["pink", "white", "green"]
  - Setting type: outdoor/studio/urban
  - Lighting style: natural/studio/dramatic

### Step 2: Generate video with specific properties
```
Query: "Generate a quirky, high-energy video with warm colors for campaign 1"
```
**Expected Response:**
- Video generation started with property overrides
- Properties applied: mood=quirky, energy_level=high_energy, color_temperature=warm
- Templated prompt built from properties
- Video generated and analyzed
- Extracted properties shown for verification

### Step 3: Try different property combinations
```
Query: "Generate a serene, calm video with cool colors and dramatic lighting for campaign 3"
```
**Expected Response:**
- Video generated with:
  - mood: serene
  - energy_level: calm
  - color_temperature: cool
  - lighting_style: dramatic
- Auto-analysis confirms properties match request
- Saved as artifact

### Step 4: Compare properties across ads
```
Query: "Show the video properties for all ads in campaign 1 and compare them"
```
**Expected Response:**
- List of all campaign 1 ads with properties
- Side-by-side comparison:
  - Mood distribution
  - Energy level patterns
  - Color temperature trends
- Insights on which combinations perform best

### Step 5: Apply properties from top performer
```
Query: "Apply the video properties from our top performer to campaign 4"
```
**Expected Response:**
- Top performer identified with its video_properties
- Properties extracted: mood, visual_style, energy_level, color_temperature, lighting_style
- New video generated for campaign 4 using these properties
- Winning formula applied with precision control

---

## Video Properties Reference

Every generated video is automatically analyzed by Gemini 2.5 Pro to extract 25+ structured properties. These properties enable:
- Correlation analysis between video characteristics and performance
- Property-controlled video generation (specify mood, energy, colors)
- Applying winning formulas from top performers

### Controllable Properties (for generation)

| Property | Values | Example |
|----------|--------|---------|
| `mood` | quirky, warm, bold, serene, mysterious, playful, sophisticated, energetic, elegant, romantic | "Generate a quirky video" |
| `visual_style` | cinematic, documentary, editorial, commercial, artistic, minimalist, vintage, modern | "Create an editorial style video" |
| `energy_level` | calm, moderate, dynamic, high_energy | "Make it high-energy" |
| `color_temperature` | warm, neutral, cool | "Use warm colors" |
| `camera_movement` | static, pan, orbit, track, dolly, crane, handheld, slow_zoom | "Use a slow orbit camera" |
| `lighting_style` | natural, studio, dramatic, soft, high_key, low_key, golden_hour, neon | "With dramatic lighting" |
| `setting_type` | outdoor, studio, urban, nature, indoor, beach | "In an urban setting" |
| `time_of_day` | golden_hour, day, night, dawn, dusk | "During golden hour" |

### Extracted Properties (from analysis)

| Category | Properties |
|----------|------------|
| **Mood/Emotion** | `mood`, `mood_intensity` (0-1), `has_warmth` (bool) |
| **Visual** | `visual_style`, `camera_movement`, `lighting_style` |
| **Energy** | `energy_level`, `movement_amount` (0-1) |
| **Color** | `color_temperature`, `dominant_colors` (list), `color_saturation` (0-1) |
| **Subject** | `subject_count`, `garment_visibility` (0-1), `has_multiple_outfits` |
| **Scene** | `setting_type`, `time_of_day`, `background_complexity` (0-1) |
| **Style** | `style_tags` (list), `quality_score` (0-1) |
| **Production** | `aspect_ratio`, `has_text_overlays`, `has_brand_elements` |

---

## Visualization Types Reference

### Chart Types (Analytics Agent)

Charts use **anti-hallucination templates** with explicit data values from `video_metrics` table.

| Type | Description | Best For |
|------|-------------|----------|
| `trendline` | Line chart with exact data points | Daily RPI/impression trends |
| `bar_chart` | Bar chart with weekly aggregates | Comparing periods |
| `comparison` | Multi-metric KPI dashboard card (2x2 grid) | Executive summary |
| `infographic` | Comprehensive visual with mini charts | Presentations |

**Metrics available:** `revenue_per_impression`, `impressions`, `dwell_time`, `circulation`

**Template Features:**
- Explicit "DO NOT invent" clauses prevent AI from fabricating data
- All data points listed in prompt with exact values
- Statistics (min, max, avg, trend) pre-calculated from DB
- 16:9 aspect ratio for presentation quality

### Map Types (Analytics Agent)

**AI-Generated Map Visualizations** (`generate_map_visualization`):

| Type | Description | Example Query |
|------|-------------|---------------|
| `performance_map` | US map with revenue bubbles by location | "Show campaign performance on a map" |
| `regional_comparison` | West/East/Midwest comparison bars | "Compare West Coast vs East Coast" |
| `category_by_region` | Fashion categories by geography | "Show categories by region" |
| `market_opportunity` | Expansion potential visualization | "Where should we expand?" |
| `campaign_heatmap` | Revenue density overlay | "Create a revenue heatmap" |

**Visualization Styles** (NEW - `style` parameter):

| Style | Description | Best For |
|-------|-------------|----------|
| `infographic` | Clean business dashboard (default) | Executive presentations, reports |
| `artistic` | Magazine-quality editorial | Marketing materials, creative reviews |
| `simple` | Minimal, data-focused design | Quick data checks, technical analysis |

**Google Maps Integration Tools** (NEW):

| Tool | Description | Returns |
|------|-------------|---------|
| `get_campaign_map_data()` | Rich location data with links | Google Maps URLs, product images, video URLs, metrics |
| `generate_static_map()` | Real Google Static Maps image | Map image URL with color-coded markers |

**Static Map Options** (`generate_static_map`):

| Parameter | Values | Description |
|-----------|--------|-------------|
| `map_type` | roadmap, satellite, terrain, hybrid | Google Maps base style |
| `color_by` | status, revenue | Marker coloring scheme |
| `size` | "640x480", "800x600" | Image dimensions |

---

## Quick Reference: Single-Purpose Queries

For quick demos of specific features:

### HITL Workflow (Start Here!)
```
"Show me all campaigns and their video status"
"Show me the video review table with preview links"
"List all pending videos for review"
"Activate videos 1 and 2"
"Get activation summary for campaign 1"
```

### Campaign Management
```
"List all campaigns"
"Show me all active campaigns"
"Create a campaign for the elegant black cocktail dress at our Miami store"
"Update campaign 4 to active status"
"What campaigns are in draft status?"
```

### Product Browsing
```
"Show me all available products"
"List products in the dress category"
"What products do we have for a summer campaign?"
```

### Video Generation (Two-Stage Pipeline)
```
"Generate a video for campaign 1 with an Asian model on a beach at golden hour"
"Generate a video with a European model in an urban setting"
"What variation options do I have for video generation?"
"Show me variation presets"
```

### Analytics (Post-Activation)
```
"Get metrics for campaign 1 for the last 30 days"
"What's the RPI and dwell time for the Blue Floral Maxi Dress campaign?"
"What are the top 5 best performing video ads by revenue per impression?"
"Show me top performers ranked by dwell time"
"Give me insights on campaign 1. What's working?"
"Compare campaigns 1, 2, 3, and 4 side by side"
"Which campaign has the best RPI?"
```

### Chart Generation (Anti-Hallucination Templates)
```
"Generate a trendline chart showing revenue per impression for campaign 1 over 30 days"
"Create a bar chart of weekly impressions for campaign 1"
"Generate a comparison KPI card for campaign 1 showing all metrics"
"Create an infographic visualization of campaign 1 performance"
```

### Location Features & Google Maps
```
"Show me all campaign locations with Google Maps links"
"Get all campaign locations with product and video info"
"Create a static map with all store locations"
"Generate a static map colored by revenue"
"Search for fashion stores near Los Angeles"
"What are the demographics for New York?"
```

### Map Visualizations (with style options)
```
"Generate a performance map showing all campaigns on a US map"
"Create an infographic map showing campaign performance"
"Create an artistic magazine-style map visualization"
"Create a regional comparison map showing West Coast vs East Coast RPI"
"Generate a market opportunity visualization in infographic style"
"Create a revenue heatmap"
```

### Property-Controlled Video Generation
```
"Generate a quirky, high-energy video with warm colors for campaign 1"
"Generate a video for campaign 3 with mood serene and energy level calm"
"Create a bold, cinematic video with dramatic lighting for campaign 2"
"Generate a playful video with cool color temperature for campaign 1"
```

### Video Properties
```
"Get video properties for video 1"
"Show video properties for all videos in campaign 1"
"What are the properties of our top performing videos?"
"Compare video properties across our best videos"
```

### Advanced
```
"Apply the winning formula from the top video to campaign 4"
"Generate 3 variations with different moods for campaign 1"
"What characteristics do our top performers share?"
```

---

## Recommended Test Flow (Copy-Paste Ready)

Use this sequence to test the full HITL workflow end-to-end:

### Step 1: Check Current State
```
Show me all campaigns and their video status
```

### Step 2: View Pending Videos
```
Show me the video review table with preview links
```

### Step 3: Activate Videos (Generates Metrics)
```
Activate videos 1 and 2
```

### Step 4: Verify Activation
```
Get activation summary for campaign 1
```

### Step 5: Check Metrics (Post-Activation)
```
Get metrics for campaign 1
```

### Step 6: Generate Chart
```
Generate a trendline chart showing RPI for campaign 1 over 30 days
```

### Step 7: Compare Campaigns
```
Compare all campaigns and tell me which has the best performance
```

### Step 8: Generate Map
```
Generate a performance map showing all campaigns on a US map
```

---

## Analytics Function Reference

| Function | Query Example | What It Returns |
|----------|---------------|-----------------|
| `get_campaign_metrics` | "Get metrics for campaign 1" | Daily + aggregated metrics from `video_metrics` |
| `get_top_performing_ads` | "Top 5 videos by RPI" | Ranked videos with product info from `campaign_videos` |
| `get_campaign_insights` | "Insights for campaign 1" | Trend analysis, best/worst days, recommendations |
| `compare_campaigns` | "Compare campaigns 1 and 2" | Side-by-side with `video_count`, `activated_count` |
| `generate_metrics_visualization` | "Create a trendline chart" | AI-generated chart using anti-hallucination templates |
| `get_campaign_map_data` | "Show campaign locations" | Google Maps URLs, product images, video URLs |
| `generate_map_visualization` | "Create a performance map" | AI-generated infographic map |

---

## Demo Tips

1. **HITL is key**: Videos must be ACTIVATED before metrics appear. Show the workflow:
   - Generate video → status='generated' (no metrics)
   - Activate video → status='activated' (30 days of metrics created)
   - Use Review Agent for activation

2. **Wait for video generation**: Veo 3.1 takes 2-5 minutes. Use this time to explain the process or show other features.

3. **Check artifacts**: After generating videos/images/charts, remind viewers they can see them in the ADK Web UI artifacts panel.

4. **Use natural language**: The agent understands context. You don't need exact command syntax.

5. **Build on previous responses**: Reference "the top performer" or "that campaign" - the agent maintains context.

6. **Show the handoff**: Point out when the coordinator delegates to specialized agents.

7. **Metrics use NEW schema**: All analytics functions query `video_metrics` + `campaign_videos` tables. The column is `dwell_time_seconds` (not `dwell_time`).

8. **Video properties are auto-extracted**: Every video is automatically analyzed after generation to extract mood, energy, style, and 25+ other properties. Show this by asking "Get video properties for video X" after generating.

9. **Property-controlled generation**: Demonstrate fine-grained control by requesting specific mood (quirky, warm, bold), energy (calm, dynamic), colors (warm, cool), and lighting (dramatic, natural). The system builds templated prompts from these properties.

10. **Google Maps links are clickable**: When you get campaign map data, the `google_maps_url` links open directly in Google Maps (browser or app). Great for showing real store locations to stakeholders.

11. **Three map visualization styles**: Try different styles for different audiences:
    - `infographic` for executives and presentations
    - `artistic` for marketing and creative teams
    - `simple` for quick data checks

12. **Static vs AI Maps**: Use `generate_static_map()` for real Google Maps images with markers. Use `generate_map_visualization()` for AI-generated infographics with more creative control.

13. **Anti-hallucination charts**: Chart generation uses structured templates with explicit data values. The prompt includes "DO NOT invent" rules to prevent AI from fabricating data points. Charts show ONLY real data from `video_metrics` table.

14. **RPI is THE key metric**: Revenue Per Impression is the primary KPI for retail media. Always highlight RPI when discussing performance.
